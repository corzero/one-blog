(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9a5b3586"],{"9e55":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-form",{attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"添加新分类"}},[n("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},model:{value:t.addCategory,callback:function(e){t.addCategory=e},expression:"addCategory"}}),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:"保存",placement:"top"}},[n("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",size:"small"},on:{click:t.categoryAdd}})],1)],1)],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.categoryList,"expand-row-keys":t.expandRow,"row-key":"_id"},on:{"expand-change":t.expandChange}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.tagList,function(e){return n("el-tag",{key:e._id,staticStyle:{"margin-right":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.tagDelete(e._id)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}),t._v(" "),t.addTagVisible?n("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(n){return t.handleInputConfirm(e.row._id)}},nativeOn:{keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.handleInputConfirm(e.row._id)}},model:{value:t.addTag,callback:function(e){t.addTag=e},expression:"addTag"}}):n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 新增")])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"分类名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.editCategory._id===e.row._id?n("el-input",{ref:"name",staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.editCategory.name,callback:function(e){t.$set(t.editCategory,"name",e)},expression:"editCategory.name"}}):n("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"标签个数",prop:"tagList.length"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.editCategory._id!==e.row._id?n("div",[n("el-tooltip",{attrs:{effect:"dark",content:"编辑",placement:"top"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",size:"small"},on:{click:function(n){return n.stopPropagation(),t.categoryEdit(e.row)}}})],1),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top"}},[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"small"},on:{click:function(n){return n.stopPropagation(),t.categoryDelete(e.row)}}})],1)],1):n("div",[n("el-tooltip",{attrs:{effect:"dark",content:"取消",placement:"top"}},[n("el-button",{attrs:{type:"danger",icon:"el-icon-close",circle:"",size:"small"},on:{click:function(e){return e.stopPropagation(),t.resetCategory()}}})],1),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:"保存",placement:"top"}},[n("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",size:"small"},on:{click:function(n){return n.stopPropagation(),t.categorySave(e.row._id)}}})],1)],1)]}}])})],1)],1)},i=[],r=(n("6762"),n("2fdb"),n("96cf"),n("3b8d")),o=n("365c"),s={data:function(){return{addTagVisible:!1,addTag:"",addCategory:"",editCategory:{_id:null,name:null,tag:[],shop:null,shopId:null},expandRow:[],categoryList:[]}},created:function(){this.getCategoryListTag()},methods:{getCategoryListTag:function(){var t=this;o["category"].getWithTag().then(function(e){t.categoryList=e.data})},showInput:function(){var t=this;this.addTagVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(t){console.log(t);var e=this.addTag;e&&this.tagAdd(t,e),this.addTagVisible=!1,this.addTag=""},categoryEdit:function(t){console.log(t),this.editCategory=Object.assign({},t)},categoryDelete:function(){},categorySave:function(t){var e=this,n=this.editCategory.tagList.map(function(t){return t._id});console.log(n),o["category"].update(Object.assign({},this.editCategory,{tagList:n})).then(function(t){e.$Message.success("更新成功")}),this.categoryList=this.categoryList.map(function(n){return n._id===t?Object.assign({},e.editCategory):n}),this.resetCategory()},categoryAdd:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["category"].create({name:this.addCategory});case 2:this.getCategoryListTag();case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),resetCategory:function(){this.editCategory={_id:null,name:null,tag:[],shop:null,shopId:null}},tagEdit:function(){},tagDelete:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["tag"].delete({ids:[e]});case 2:this.getCategoryListTag();case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),tagAdd:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["tag"].create({category:e,name:n});case 2:this.getCategoryListTag();case 3:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}(),expandChange:function(t,e){this.expandRow=this.expandRow.includes(t._id)?[]:[t._id]}}},c=s,l=(n("a9cf"),n("2877")),u=Object(l["a"])(c,a,i,!1,null,"4818310a",null);e["default"]=u.exports},a9cf:function(t,e,n){"use strict";var a=n("b926"),i=n.n(a);i.a},b926:function(t,e,n){}}]);